<!DOCTYPE html> <html lang=en style><!--
 Page saved with SingleFile 
 url: https://ianthehenry.com/posts/how-to-learn-nix/python3-alpha/ 
 saved date: Mon Jul 17 2023 13:35:12 GMT+0600 (Kyrgyzstan Time)
--><meta charset=utf-8>
<meta name=viewport content="initial-scale=1,maximum-scale=1">
<title>How to Learn Nix, Part 39: How to install Python</title>
<link rel=canonical href=https://ianthehenry.com/posts/how-to-learn-nix/python3-alpha/>
<style>:root{--box-radius:6px;--outer-box-radius:10px}:root{--content-bg:#fff;--gutter-bg:#eeeef3;--text-fg:#4d4d4c;--table-border-color:#ccc;--separator-color:#6d6d6c;--link:#07c;--link-visited:#751a9a;--blockquote-accent:var(--link);--footnote-accent:#ffd2a3;--subscribe-button-bg:#44e66c;--subscribe-button-fg:#11391b;--media-controls-on:#34b553;--media-controls-contrast:#fff;--inline-code-bg:#f3f3fa;--code-block-bg:#f3f3fa;--aside-bg:#f3f3fa;--aside-warning-bg:#fff5d1;--aside-warning-fg:#ac3233;--palette-red:#c82829;--palette-green:#718c00;--palette-yellow:#eab700;--palette-orange:#f5871f;--palette-blue:#4271ae;--palette-purple:#8959a8;--palette-teal:#3e999f;--palette-white:#fefefe;--palette-black:#000;--palette-text:var(--text-fg);--palette-dim:#8e908c;--highlight-bg:var(--palette-yellow);--highlight-fg:var(--text-fg)}#dmt::before{content:"🌖"}#dmt:hover::before{content:"🌗"}@media (prefers-color-scheme:dark){:root:not(.light-theme){--content-bg:#313233;--gutter-bg:#1d1f21;--text-fg:#d8d4cf;--table-border-color:#ccc;--separator-color:#6d6d6c;--link:rgb(82,183,255);--link-visited:rgb(193,104,229);--blockquote-accent:var(--link);--footnote-accent:#a8612f;--subscribe-button-bg:#44e66c;--subscribe-button-fg:#11391b;--media-controls-on:#44e66c;--media-controls-contrast:#11391b;--inline-code-bg:#3c4044;--code-block-bg:#1d1f21;--aside-bg:#3c4044;--aside-warning-bg:#fff5d1;--aside-warning-fg:var(--palette-red);--palette-red:#cc6666;--palette-green:#b5bd68;--palette-yellow:#f0c674;--palette-orange:#de935f;--palette-blue:#81a2be;--palette-purple:#b294bb;--palette-teal:#8abeb7;--palette-white:#fefefe;--palette-black:#000;--palette-text:var(--text-fg);--palette-dim:#969896;--highlight-bg:var(--palette-yellow);--highlight-fg:var(--palette-black)}:root:not(.light-theme) #dmt::before{content:"🌒"}:root:not(.light-theme) #dmt:hover::before{content:"🌓"}}#dmt{width:30px;text-align:right;padding-right:4px;position:absolute;top:0;bottom:0;right:0;border:none;background-color:inherit;cursor:pointer}*{margin:0;padding:0;font:inherit;box-sizing:border-box}html{background-color:var(--gutter-bg);color:var(--text-fg)}body{font-family:system-ui,sans-serif;font-size:12pt;line-height:1.8;word-wrap:break-word}body:not(.content-page) main>aside{padding:0 var(--content-padding)}body.content-page main,body:not(.content-page) article{background-color:var(--content-bg);border-radius:var(--outer-box-radius);padding:var(--content-padding)}pre{word-wrap:normal}em,i{font-style:italic}sup{font-size:75%}sup a::before{content:"["}sup a::after{content:"]"}h1>a:only-child,h2>a:only-child{display:block}main .subsection-header+.post-list{margin-top:0}strong{font-weight:700}ol,ul{padding-left:3ch}.footnotes>ol{margin-top:1em}.footnotes li:not(.highlight){transition:background-color 1s}hr{border-style:solid;border-width:1.5px 0 0;border-radius:1px;border-color:var(--separator-color)}:not(pre)>code{white-space:pre;background-color:var(--inline-code-bg)}li{padding-left:0}blockquote{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:"";content:none}a,a:active,a:visited{text-decoration:none}a:hover{text-decoration:underline}blockquote{padding:0 0 0 var(--content-padding);border-left:solid 2px var(--blockquote-accent)}aside{--content-padding:0.5em;padding:.5em;border-radius:var(--box-radius);background-color:var(--aside-bg)}a,a:active,header a:visited,footer a:visited,h1 a:visited{color:var(--link)}a:visited{color:var(--link-visited)}a.footnote-ref:visited,a.footnote-backref:visited,.notation-help-link-container a:visited{color:var(--link)}h1{font-size:130%}main *+p,main *+pre,main *+aside,main *+section,main *+article,main *+blockquote,main *+div,main *+ul,main *+ol,main *+h1{margin-top:1em}main pre+div.highlight{margin-top:1px}main .post-header *+h1{margin-top:0}code{font-family:Menlo,monospace;padding:0 3px;border-radius:2px}pre{background-color:var(--code-block-bg);font-size:11pt;padding:calc(.75*var(--content-padding)) var(--content-padding);line-height:1.3;border-radius:var(--box-radius);overflow-x:scroll;-webkit-overflow-scrolling:touch}pre code{padding:0;border-radius:0;display:inline-block;background-color:initial}p+p{margin-top:1em}body{margin:0 auto;--content-padding:10px;max-width:768px;-webkit-text-size-adjust:100%;position:relative}header{position:relative}header>*{height:48px;line-height:48px}.promo,.promo:visited,.promo:active{display:block;text-align:center;background-color:var(--link);color:var(--code-block-bg);border-radius:0 0 var(--outer-box-radius) var(--outer-box-radius)}header .site-title{font-size:130%}header nav{position:absolute;right:30px;top:0}@media all and (max-width:400px){:root{--outer-box-radius:0}header{text-align:center}header nav{position:static}:not(pre)>code{white-space:pre-wrap}body{--content-padding:10px}#dmt{padding:0;text-align:center;width:40px}}header ul{padding:0}header li{list-style:none;display:inline-block}header a{display:block;height:100%}header li+li{margin-left:1em}footer{padding:2em 0;font-size:.85em;text-align:center}article h1.post-title{font-size:200%}article .post-title a{display:block}article .meta{font-size:90%;font-style:italic}.post-header h1{line-height:1.2em;margin-bottom:.5em}.post-footer{text-align:center}.post-footer a{display:block}ol.post-list{list-style-position:inside;padding:0}.series-rider .series-name{font-style:italic}.highlight{color:var(--palette-text)}.highlight .err{color:var(--palette-red)}.highlight .k{color:var(--palette-purple)}.highlight .n{color:var(--palette-text)}.highlight .o{color:var(--palette-teal)}.highlight .p{color:var(--palette-text)}.highlight .no{color:var(--palette-red)}.highlight .mi{color:var(--palette-orange)}.highlight .si{color:var(--palette-orange)}</style>
<meta property=og:title content="How to Learn Nix, Part 39: How to install Python">
<meta property=og:type content=website>
<meta property=og:url content=https://ianthehenry.com/posts/how-to-learn-nix/python3-alpha/>
<meta name=description content="So this isn’t great:
$ nix-env -i python3
installing 'python3-3.10.0a5'
Why isn’t this great? Well, because in the Python versioning scheme, python3-3.10.0a5 is short for “Python 3.10.0 alpha version 5.” The latest stable release of the Python reference implementation, right now, is actually 3.9.5. 3.10 is currently considered the “pre” branch, and 3.11 is currently the “dev” branch. I think; I’m not really a Python person.
So it’s not great that a new Nix user might try to install python3 and wind up with some random alpha version of Python (the latest in the 3.10 branch is actually 3.10.0b2, for whatever that’s worth).
But it’s even less great because – at the time that I am writing these words right now – the python3-3.10.0a5 derivation is broken, and will not build.">
<meta property=og:description content="So this isn’t great:
$ nix-env -i python3
installing 'python3-3.10.0a5'
Why isn’t this great? Well, because in the Python versioning scheme, python3-3.10.0a5 is short for “Python 3.10.0 alpha version 5.” The latest stable release of the Python reference implementation, right now, is actually 3.9.5. 3.10 is currently considered the “pre” branch, and 3.11 is currently the “dev” branch. I think; I’m not really a Python person.
So it’s not great that a new Nix user might try to install python3 and wind up with some random alpha version of Python (the latest in the 3.10 branch is actually 3.10.0b2, for whatever that’s worth).
But it’s even less great because – at the time that I am writing these words right now – the python3-3.10.0a5 derivation is broken, and will not build.">
<meta property=og:image content=https://ianthehenry.com/checkerboard.png>
<meta name=twitter:creator content=@ianthehenry>
<meta name=twitter:card content=summary>
<link type=image/x-icon rel="shortcut icon" href="data:image/vnd.microsoft.icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAHH1uIDShg/xEsZv8GFk3/CSJb/wgZT/8IGU//CBlP/wkiW/8HGE7/CBlP/wkiW/8HIFX/BxhO/wcgVf8OK2t7JDhz/wcfW/8NNn7/CSpq/wkjYf8MJGP/DCJg/w02ef9SqdX/TKHJ/1my2f9Moc3/UqzV/1Cr1v9Pocf/Ditr/xk2cf8KJGL/CjR8/wwva/8RK2r/Cido/w8qa/8LLW//TqjT/1Gnz/9bsNf/Sp/K/1Wt2f9Wrtj/UKjQ/w8xc/8gPHj/Di5w/xk4ef8TL27/Dy5u/xU3fv8QLGv/Ditr/1qy3f9dttv/Yrje/0ecx/9Knsz/U6fQ/1m13f8YN3n/JjZx/wszdv8YOXz/Eilm/xc3e/8dSZT/GDJz/xk/hv9hu+P/WbHZ/1mv1v9Kn8z/WLHd/1212v9ds9n/Eipr/xcqYv8SOX3/GzRz/xQrZ/8aM3D/HEuU/xc0df8fPYD/Yrre/1603P9dt9z/VKvY/1iz4v9etNr/Y73m/xk5fP8cMm3/JEWK/xc0dP8eO3v/Hjd4/ydRnP8WM3P/Gjd3/2bA5/9dtd//Ybng/2K95v9ct+P/Ybnf/2K95/8oS5L/GChg/xxBh/8lSIz/GC5s/yM5ev8hRoz/HTp7/yE6e/9Zsdz/YLzn/2jF7v9ryfL/YLzn/1qu1f9htdz/GDyD/y0/ev9qx/X/acDn/1235v9euun/Yb3r/1665v9owu7/GUOL/yhGh/8nUJL/MkmI/yBFiP8jOHb/MVag/yM+gv8VMGv/acXx/27G7/9szv3/bMb1/2zD6/9vy/X/edf5/yBHjv8yS47/JEuO/zVLiv8nS5D/LkOB/yRXpP8lQoT/H0WI/3fS+P910Pf/b8/8/2bB7/991Pn/eNb+/3nT+P8pS5L/O1GS/ytUnP86UJH/NF2k/zNLjP8sXKv/JkCB/x4+ff+B2/3/etT9/4He//922f//fNf//3TT//991/7/NU6N/zZSkP86Zav/PlWR/zFepv88ZKb/MF2n/yQ/gf8bNXH/fd3//3/b//+K6P//ft///3vV//993f//gdz//0hWlf9FZKX/RmOj/0JXlv9IeMP/QXKz/0Jsuf8eO3z/Hjt2/3vd//+C3v//ju3//3zg//+H4v//guL//4nj//9HXp3/UGur/ztgqf9JYqP/S3G4/05ur/9EbLT/Hjt7/zNJhf+G4///heT//4rq//+E5///iOT//4jr//+G4///UXO0/09iov9EX6H/SWWn/1V5wP9Kaa7/RGSp/ydLj/8NKGCfDShg/x8+d/8RLGb/CBlP/wYWTf8GFEj/CBNH/wooZP8JIlv/CCJd/woWSf8HGE7/ByBV/wwgU/8fO3mfAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="><meta http-equiv=content-security-policy content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:; object-src 'self' data:; frame-src 'self' data:;"><style>img[src="data:,"],source[src="data:,"]{display:none!important}</style></head>
<body class=content-page>
<a class=promo href=https://janet.guide/ target=_blank><i>psst, hey kid, wanna read a weird programming book</i></a>
<header>
<a class=site-title href=https://ianthehenry.com/>Ian Henry</a>
<nav>
<ul><li><a href=https://ianthehenry.com/about/>About</a><li><a href=https://ianthehenry.com/posts/>Blog</a><li><a href=https://ianthehenry.com/stuff/>Stuff</a></ul>
</nav>
<button id=dmt title="Toggle dark mode"></button>
</header>
<main>
<aside class=series-rider>
<p>This post is part of the series <a class=series-name href=https://ianthehenry.com/posts/how-to-learn-nix/>How to Learn Nix</a>, a rambling diary in which I work my way through the Nix manual in excrutiating detail.</p>
</aside>
<article class=post>
<div class=post-header>
<time class=meta datetime=2021-06-06>June 6, 2021</time>
<h1 class=post-title>
<a href=https://ianthehenry.com/posts/how-to-learn-nix/python3-alpha/>How to Learn Nix, Part&nbsp;39:<br>How to install Python</a></h1>
</div>
<div class=post-content><p>So this isn’t great:</p>
<pre tabindex=0><code>$ nix-env -i python3
installing 'python3-3.10.0a5'
</code></pre><p>Why isn’t this great? Well, because in the Python versioning scheme, <code>python3-3.10.0a5</code> is short for “Python 3.10.0 alpha version 5.” The latest stable release of the Python reference implementation, right now, is actually <code>3.9.5</code>. <code>3.10</code> is currently considered the “pre” branch, and <code>3.11</code> is currently the “dev” branch. I think; I’m not really a Python person.</p>
<p>So it’s not great that a new Nix user might try to install <code>python3</code> and wind up with some random alpha version of Python (the latest in the <code>3.10</code> branch is actually <code>3.10.0b2</code>, for whatever that’s worth).</p>
<p>But it’s even <em>less</em> great because – at the time that I am writing these words right now – the <code>python3-3.10.0a5</code> derivation is broken, and will not build.</p>
<p>I mean, maybe that’s actually a good thing: maybe it’s better that you have to stop and think and don’t just silently end up with the “wrong” version of Python. But… that’s a small consolation.</p>
<p>And of course I have to caveat all of this with a huge: you <em>shouldn’t</em> be running <code>nix-env -i python3</code>. That’s a bad thing, for a few reasons:</p>
<ol>
<li>Dev tools like this shouldn’t be installed in your environment; they should be listed as dependencies in your <code>default.nix</code> or <code>shell.nix</code> file.</li>
</ol>
<p>Okay, but to refute that, <code>python3</code> isn’t <em>just</em> a development dependency, it’s also a useful tool to be able to drop into. I often run <code>python3</code> to start up the repl and do a little math or light string processing or whatever: I think it’s perfectly reasonable to want to install <code>python3</code> in your environment <em>in addition to</em> your actual project dependencies.</p>
<ol start=2>
<li>You shouldn’t run <code>nix-env -i python3</code>, you should run <code>nix-env -iA nixpkgs.python3</code>.</li>
</ol>
<p>Okay, sure, but every single new Nix user is going to run that first thing because that’s the “obvious” command and it’s what the quick start guide told them to run and on and on and on.</p>
<p>And even if you <em>do</em> run <code>nix-env -iA nixpkgs.python3</code>, and then you <em>later</em> run <code>nix-env -u</code> to upgrade your packages, you’re going to have the same problem: <code>nix-env -u</code> will try to replace your nice <code>python3-3.8.9</code> with <code>python3-3.10.0a5</code> – although, fortunately(?), this will fail.</p>
<pre tabindex=0><code>$ nix-env -iA nixpkgs.python3 --profile ~/scratch/profile
installing 'python3-3.8.9'

$ nix-env -u --profile ~/scratch/profile
upgrading 'python3-3.8.9' to 'python3-3.10.0a5'
...
Hunk #1 FAILED at 170.
Hunk #2 FAILED at 187.
Hunk #3 succeeded at 231 (offset 23 lines).
...
(your python remains the same)
</code></pre><p>In fact you may remember that <a href=https://ianthehenry.com/posts/how-to-learn-nix/my-first-package-upgrade/>I ran into this exact issue</a> some months ago, but got around it by <a href=https://ianthehenry.com/posts/how-to-learn-nix/declarative-user-environment/>never using <code>nix-env -u</code> again</a>. But that was sort of a cop-out, wasn’t it? Let’s dive back in, and see if we can get to the bottom of this.</p>
<h1 id=of-all-the-things-we-could-be-worrying-about>Of all the things we could be worrying about</h1>
<p>I’ve heard from a lot of people since I started writing this series: I’ve received more “comments” about Nix than any other subject I’ve blogged about. Which, like, I do realize that I’ve now written far more about Nix than any other subject, but my other posts are generally <em>better</em> and more interesting and less rambling and contain fewer long weird run-on sentences like this one because I actually proof-read them before I hit publish.</p>
<p>But last week was a first, for me. Last week I received my first ever email from someone <em>asking for help</em>. With <em>Nix</em>. And, I mean, you can see exactly how much I know about Nix, by reading this series. It ain’t much. But still: rather than post on StackOverflow, or the NixOS Discourse, or any other more useful, reputable platform, this person asked <em>me</em>. And they basically asked me: what’s up with this Python thing?</p>
<p>I was flattered that someone thought I knew something about Nix, and then I realized I actually did know something about Nix, sort of, and in the process of replying I learned a few more things about Nix, so now we’re going to re-trace my steps a bit so that you can also learn something about Nix.</p>
<p>So.</p>
<p>If you know much about Nix, you probably understand the problem: there are lots of packages “named” <code>python3</code>:</p>
<pre tabindex=0><code>$ nix-env -qa python3 --json | jq '.[] |= .name'
{
  "nixpkgs.python310": "python3-3.10.0a5",
  "nixpkgs.python36": "python3-3.6.13",
  "nixpkgs.python36Full": "python3-3.6.13",
  "nixpkgs.python37Full": "python3-3.7.10",
  "nixpkgs.python37": "python3-3.7.10",
  "nixpkgs.gnuradio3_8Packages.python": "python3-3.8.9",
  "nixpkgs.python38Full": "python3-3.8.9",
  "nixpkgs.python3Full": "python3-3.8.9",
  "nixpkgs.sourcehut.python": "python3-3.8.9",
  "nixpkgs.python39": "python3-3.9.4",
  "nixpkgs.python39Full": "python3-3.9.4"
}
</code></pre><p>There is also obviously one at <code>nixpkgs.python3</code>, but apparently <code>nix-env -qa</code> only shows the “first” example of each derivation, and <code>python3</code> is reference-equal to one of the other <code>python3-3.8.9</code>s:</p>
<pre tabindex=0><code>nix-repl&gt; :l &lt;nixpkgs&gt;
Added 14312 variables.

nix-repl&gt; python3 == python38Full
false

nix-repl&gt; python3 == python3Full
false

nix-repl&gt; python3 == sourcehut.python
true
</code></pre><p>And for some reason that gets enumerated first, I guess.</p>
<p>Now, in the case that there are multiple packages named <code>"python3"</code>, we remember that <code>nix-env</code> will use <code>meta.priority</code> to differentiate them. So why isn’t that working?</p>
<pre tabindex=0><code>$ nix-env -qa python3 --json | jq '.[] |= .meta.priority'
{
  "nixpkgs.python310": null,
  "nixpkgs.python36": null,
  "nixpkgs.python36Full": null,
  "nixpkgs.python37Full": null,
  "nixpkgs.python37": null,
  "nixpkgs.gnuradio3_8Packages.python": null,
  "nixpkgs.python38Full": null,
  "nixpkgs.python3Full": null,
  "nixpkgs.sourcehut.python": null,
  "nixpkgs.python39": null,
  "nixpkgs.python39Full": null
}
</code></pre><p>Ah, yes, well, that would do it.</p>
<p>So that’s unfortunate: this is exactly the mechanism designed to fix this issue, but Nixpkgs is not employing it, because… well, because who knows. It’s a complicated world.</p>
<p>And since all of those packages have the same priority, Nix is falling back to version comparison, and picking the package with the highest version. Which is, in this case, <code>3.10.0a5</code>.</p>
<p>But just because Nixpkgs doesn’t set <code>meta.priority</code> doesn’t mean that <em>we</em> can’t set <code>meta.priority</code>. We’re smart, confident Nix users. We can change the world, if we believe enough.</p>
<p>So my first thought was: I remember this weird obscure command, <code>nix-env --set-flag</code>. From <code>man nix-env</code>:</p>
<blockquote>
<p>The <code>--set-flag</code> operation allows meta attributes of installed packages to be modified. There are several attributes that can be usefully modified, because they affect the behaviour of <code>nix-env</code> or the user environment build script:</p>
<ul>
<li>priority […boring stuff elided; I probably get it…]</li>
<li>keep […same…]</li>
<li>active […same…]</li>
</ul>
</blockquote>
<p>Sounds perfect!</p>
<p>However, when I actually <em>read</em> the description of <code>priority</code>, I realize that I had completely misunderstood:</p>
<blockquote>
<p><code>priority</code> can be changed to resolve filename clashes. The user environment build script uses the <code>meta.priority</code> attribute of derivations to resolve filename collisions between packages. Lower priority values denote a higher priority. For instance, the GCC wrapper package and the Binutils package in Nixpkgs both have a file <code>bin/ld</code>, so previously if you tried to install both you would get a collision. Now, on the other hand, the GCC wrapper declares a higher priority than Binutils, so the former’s <code>bin/ld</code> is symlinked in the user environment.</p>
</blockquote>
<p>Okay. So <code>meta.priority</code> apparently means two different things. It not only decides which packages you install, but also whose files emerge victorious in the case of a collision during user environment construction.</p>
<p>And <code>--set-flag</code> can only usefully affect the latter, because:</p>
<blockquote>
<p>The <code>--set-flag</code> operation allows meta attributes of installed packages to be modified.</p>
</blockquote>
<p>You must have already installed the package in order to change this attribute, so it’s no use to us. Since we’re trying to affect which package <em>gets</em> installed, we’ll need to go to the source. Er, the metaphorical source. Not the source code, necessarily.</p>
<p>Because we remember the non-intrusive way to make changes to derivations: <a href=https://ianthehenry.com/posts/how-to-learn-nix/overriding/>overrides</a>. Right?</p>
<p>Sure. So I open up my <code>~/.config/nixpkgs/config.nix</code>, and write this:</p>
<pre><code>$ cat ~/.config/nixpkgs/config.nix
</code></pre>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=p>{</span>
  <span class=n>allowUnfree</span> <span class=o>=</span> <span class=no>true</span><span class=p>;</span>
  <span class=n>packageOverrides</span> <span class=o>=</span> <span class=n>pkgs</span><span class=p>:</span> <span class=p>{</span>
    <span class=n>python3</span> <span class=o>=</span> <span class=n>pkgs</span><span class=o>.</span><span class=n>python3</span><span class=o>.</span><span class=n>overrideAttrs</span> <span class=p>(</span><span class=n>attrs</span><span class=p>:</span> <span class=n>attrs</span> <span class=o>//</span> <span class=p>{</span> <span class=n>meta</span><span class=o>.</span><span class=n>priority</span> <span class=o>=</span> <span class=mi>100</span><span class=p>;</span> <span class=p>});</span>
  <span class=p>};</span>
<span class=p>}</span>
</code></pre></div><p>That doesn’t work for <em>several</em> reasons, but let’s start with the most obvious mistake I made.</p>
<p>This doesn’t set <code>meta.priority</code>.</p>
<p>This sets <code>meta</code>.</p>
<p>And it sets it to the attribute set <code>{ priority = 100; }</code>. That’s not what I wanted to do, but it is exactly what I wrote, so… I’m not <em>mad</em>, but I feel a little silly. I realize that <code>{ meta.priority = 100; }</code> is just syntax sugar for <code>{ meta = { priority = 100; }; }</code>, and obviously I wouldn’t have written <code>attrs // { meta = { priority = 100; }; }</code>, because that’s very clearly overwriting the entire <code>meta</code> attribute. But still, in my head, I wanted <code>// { foo.bar = 10; }</code> to only set that one nested key.</p>
<p>Anyway, this is the sort of mistake that you make once and never make again, hopefully, and this was the time I made it. And now maybe you will not make it, if you haven’t already.</p>
<p>Now, there’s no “deep” version of the <code>//</code> operator in Nix, so we have to turn to <code>nixpkgs.lib</code>. I <a href=https://ianthehenry.com/posts/how-to-learn-nix/an-infinite-list-of-functions/>look through the function reference</a> to remind myself the right function:</p>
<pre><code>$ cat ~/.config/nixpkgs/config.nix
</code></pre>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=p>{</span>
  <span class=n>allowUnfree</span> <span class=o>=</span> <span class=no>true</span><span class=p>;</span>
  <span class=n>packageOverrides</span> <span class=o>=</span> <span class=n>pkgs</span><span class=p>:</span>
    <span class=p>{</span>
      <span class=n>python3</span> <span class=o>=</span> <span class=n>pkgs</span><span class=o>.</span><span class=n>python3</span><span class=o>.</span><span class=n>overrideAttrs</span> <span class=p>(</span><span class=n>attrs</span><span class=p>:</span>
        <span class=n>pkgs</span><span class=o>.</span><span class=n>lib</span><span class=o>.</span><span class=n>attrsets</span><span class=o>.</span><span class=n>recursiveUpdate</span> <span class=n>attrs</span> <span class=p>{</span> <span class=n>meta</span><span class=o>.</span><span class=n>priority</span> <span class=o>=</span> <span class=mi>100</span><span class=p>;</span> <span class=p>});</span>
    <span class=p>};</span>
<span class=p>}</span>
</code></pre></div><p>Which is just… ugh. Not only is that a mouthful, but take note of the incorrect argument order, so that these functions don’t compose or allow me to write that function point-free. Annoying.</p>
<aside>
<p>In Haskell, the argument order to <code>recursiveUpdate</code> would be reversed, so you’d be able to write:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=n>python3</span> <span class=err>=</span> <span class=n>pkgs</span><span class=o>.</span><span class=n>python3</span><span class=o>.</span><span class=n>overrideAttrs</span> <span class=p>(</span><span class=n>pkgs</span><span class=o>.</span><span class=n>lib</span><span class=o>.</span><span class=n>attrsets</span><span class=o>.</span><span class=n>recursiveUpdate</span> <span class=p>{</span> <span class=n>meta</span><span class=o>.</span><span class=n>priority</span> <span class=o>=</span> <span class=mi>100</span><span class=p>;</span> <span class=p>});</span>
</code></pre></div><p>Which is either a little nicer or the worst thing you’ve ever seen, depending on which camp you happen to fall into.</p>
</aside>
<p>But even with all of those extra characters, this still doesn’t work. It still wants to install <code>3.10.0a5</code>.</p>
<pre tabindex=0><code>$ nix-env -i python3
installing 'python3-3.10.0a5'
</code></pre><p>At this point I am confused. It <em>should</em> work, right? I go back and check <code>man nix-env</code>:</p>
<blockquote>
<p>If there are multiple derivations matching a name in <code>args</code> that have the same name (e.g., <code>gcc-3.3.6</code> and <code>gcc-4.1.1</code>), then the derivation with the highest priority is used.</p>
</blockquote>
<p>That just… doesn’t seem to be true?</p>
<p>I sanity check that my override is actually happening:</p>
<pre tabindex=0><code>$ nix-env -qa python3 --json | jq '.[] |= { name, priority: .meta.priority }'
{
  "nixpkgs.python310": { "name": "python3-3.10.0a5", "priority": null },
  "nixpkgs.python36": { "name": "python3-3.6.13", "priority": null },
  "nixpkgs.python36Full": { "name": "python3-3.6.13", "priority": null },
  "nixpkgs.python37Full": { "name": "python3-3.7.10", "priority": null },
  "nixpkgs.python37": { "name": "python3-3.7.10", "priority": null },
  "nixpkgs.gnuradio3_8Packages.python": { "name": "python3-3.8.9", "priority": 100 },
  "nixpkgs.python38": { "name": "python3-3.8.9", "priority": null },
  "nixpkgs.python38Full": { "name": "python3-3.8.9", "priority": null },
  "nixpkgs.python3Full": { "name": "python3-3.8.9", "priority": 100 },
  "nixpkgs.sourcehut.python": { "name": "python3-3.8.9", "priority": 100 },
  "nixpkgs.python39": { "name": "python3-3.9.4", "priority": null },
  "nixpkgs.python39Full": { "name": "python3-3.9.4", "priority": null }
}
</code></pre><p>So my change did take, it just… doesn’t work?</p>
<p>But ah, I needed to keep reading:</p>
<blockquote>
<p>A derivation can define a priority by declaring the <code>meta.priority</code> attribute. This attribute should be a number, with a higher value denoting a lower priority. The default priority is <code>0</code>.</p>
</blockquote>
<p>Of course. When the manual said “the derivation with the highest priority is used,” it meant “the derivation with the lowest <code>priority</code>.” Obviously. And since the default priority is <code>0</code>, that means we need to set a <em>negative</em> priority for <code>nixpkgs.python3</code>. <em>Obviously</em>.</p>
<pre><code>$ cat ~/.config/nixpkgs/config.nix
</code></pre>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=p>{</span>
  <span class=n>allowUnfree</span> <span class=o>=</span> <span class=no>true</span><span class=p>;</span>
  <span class=n>packageOverrides</span> <span class=o>=</span> <span class=n>pkgs</span><span class=p>:</span>
    <span class=p>{</span>
      <span class=n>python3</span> <span class=o>=</span> <span class=n>pkgs</span><span class=o>.</span><span class=n>python3</span><span class=o>.</span><span class=n>overrideAttrs</span> <span class=p>(</span><span class=n>attrs</span><span class=p>:</span>
        <span class=n>pkgs</span><span class=o>.</span><span class=n>lib</span><span class=o>.</span><span class=n>attrsets</span><span class=o>.</span><span class=n>recursiveUpdate</span> <span class=n>attrs</span> <span class=p>{</span> <span class=n>meta</span><span class=o>.</span><span class=n>priority</span> <span class=o>=</span> <span class=mi>-100</span><span class=p>;</span> <span class=p>});</span>
    <span class=p>};</span>
<span class=p>}</span>
</code></pre></div><p>And there it is! That works. We can now install <code>python3</code> by name, or upgrade <code>python3</code> at all, and get the version we actually want:</p>
<pre tabindex=0><code>$ nix-env -i python3 --profile ~/scratch/profile
warning: there are multiple derivations named 'python3-3.8.9'; using the first one
installing 'python3-3.8.9'
</code></pre><p>Beautiful. And:</p>
<pre tabindex=0><code>$ nix-env -u --profile ~/scratch/profile
</code></pre><p>Does nothing. Good!</p>
<p>So that solves it. But it’s a little weird and gross and complicated. I would <em>prefer</em> to write something like this:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=p>{</span>
  <span class=n>allowUnfree</span> <span class=o>=</span> <span class=no>true</span><span class=p>;</span>
  <span class=n>simpleOverrides</span> <span class=o>=</span> <span class=p>{</span> <span class=n>python3</span><span class=o>.</span><span class=n>meta</span><span class=o>.</span><span class=n>priority</span> <span class=o>=</span> <span class=mi>-100</span><span class=p>;</span> <span class=p>};</span>
<span class=p>}</span>
</code></pre></div><p>So… let’s do that? It’ll be good Nix practice.</p>
<p>So, uh, how do I get a list of key-value pairs again? I would definitely expect that to be a built-in. I can see <code>builtins.attrNames</code> and <code>builtins.attrValues</code>… hmm. There’s a <code>builtins.listToAttrs</code>, but no <code>builtins.attrsToList</code>. Darn. I guess it’s a <code>lib</code> function.</p>
<p>I look through the Nixpkgs manual and I can’t find the function I want… but I find <code>mapAttrs</code>, which is a better fit here anyway.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=k>let</span> <span class=n>overridePackageAttrs</span> <span class=o>=</span> <span class=n>overrides</span><span class=p>:</span> <span class=n>pkgs</span><span class=p>:</span>
  <span class=k>let</span> <span class=n>update</span> <span class=o>=</span> <span class=k>with</span> <span class=n>pkgs</span><span class=o>.</span><span class=n>lib</span><span class=p>;</span> <span class=p>(</span><span class=n>flip</span> <span class=n>recursiveUpdate</span><span class=p>);</span> <span class=k>in</span>
  <span class=n>pkgs</span><span class=o>.</span><span class=n>lib</span><span class=o>.</span><span class=n>mapAttrs</span> <span class=p>(</span><span class=n>packageName</span><span class=p>:</span> <span class=n>attrUpdates</span><span class=p>:</span>
    <span class=n>pkgs</span><span class=o>.</span><span class=si>${</span><span class=n>packageName</span><span class=si>}</span><span class=o>.</span><span class=n>overrideAttrs</span> <span class=p>(</span><span class=n>update</span> <span class=n>attrUpdates</span><span class=p>))</span>
    <span class=n>overrides</span><span class=p>;</span>
<span class=k>in</span>
<span class=p>{</span>
  <span class=n>allowUnfree</span> <span class=o>=</span> <span class=no>true</span><span class=p>;</span>
  <span class=n>packageOverrides</span> <span class=o>=</span> <span class=n>overridePackageAttrs</span> <span class=p>{</span> <span class=n>python3</span><span class=o>.</span><span class=n>meta</span><span class=o>.</span><span class=n>priority</span> <span class=o>=</span> <span class=mi>-100</span><span class=p>;</span> <span class=p>};</span>
<span class=p>}</span>
</code></pre></div><p>I won’t walk through that in detail; I think it’s pretty straightforward. But I will point out that it’s kind of annoying that I have to declare the <code>update</code> helper <em>inside</em> the <code>overridePackageAttrs</code> function because I need access to <code>pkgs.lib</code> – I can’t <code>import &lt;nixpkgs&gt;</code> in here, since this file is <code>import</code>ed by Nixpkgs itself.<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p>
<p>That’s a little nicer looking, and will make it easy to make other trivial changes in the future. Maybe. I don’t know if there’s a built-in nice way to do this already – the manual never mentioned it, if so – but it’s so little code that I’m not too bothered.</p>
<p>Besides, it’s not like this code <em>should</em> exist. This is just putting a band-aid over a problem in Nixpkgs. The <em>right</em> solution is to set the priority in Nixpkgs itself.</p>
<p>But it feels weird to explicitly set a negative priority. I wonder if any existing packages do that?</p>
<pre tabindex=0><code>$ rg 'priority = -'
nixos/modules/services/web-servers/apache-httpd/default.nix
15:  apachectl = pkgs.runCommand "apachectl" { meta.priority = -1; } ''

pkgs/development/interpreters/python/cpython/2.7/default.nix
335:      priority = -100;

pkgs/tools/security/gnupg/1compat.nix
28:    priority = -1;

pkgs/os-specific/linux/tbs/default.nix
60:    priority = -1;

pkgs/os-specific/linux/rtw88/default.nix
38:    priority = -1;
</code></pre><p><em>What’s this?</em> Python 2.7 already does this. Is that why you don’t have any problems when you run <code>nix-env -i python</code>?<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p>
<pre tabindex=0><code>$ nix-env -qa python --json | jq '.[] |= { name, priority: .meta.priority }'
{
  "nixpkgs.gnuradio3_7Packages.python": { "name": "python-2.7.18", "priority": -100 },
  "nixpkgs.python27Full": { "name": "python-2.7.18", "priority": -100 },
  "nixpkgs.python2Full": { "name": "python-2.7.18", "priority": -100 },
  "nixpkgs.pythonFull": { "name": "python-2.7.18", "priority": -100 }
}
</code></pre><p>Er, okay. Not exactly. I guess there just… aren’t multiple <code>python</code>s. But! If there were, you wouldn’t run into this problem. Probably.</p>
<p>Anyway; this seems obviously wrong, so let’s fix it.</p>
<p>Uhhh… how?</p>
<p>I want to say: by replacing this line:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=n>python3</span> <span class=err>=</span> <span class=n>python38</span><span class=p>;</span>
</code></pre></div><p>With this line:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=n>python3</span> <span class=err>=</span> <span class=n>python38</span><span class=o>.</span><span class=n>overrideAttrs</span> <span class=p>(</span><span class=n>attrs</span><span class=p>:</span> <span class=n>lib</span><span class=o>.</span><span class=n>recursiveUpdate</span> <span class=n>attrs</span> <span class=p>{</span> <span class=n>meta</span><span class=o>.</span><span class=n>priority</span> <span class=o>=</span> <span class=mi>-100</span><span class=p>;</span> <span class=p>});</span>
</code></pre></div><p>So that we keep the change local with the reason for the change: if anyone goes in and bumps <code>python3</code> to <code>python39;</code>, then suddenly <code>python39</code> will automatically gain this higher priority. But I don’t know how <em>cool</em> this is?</p>
<p>I look through for other examples, because it looks super gross to me, and I see some examples of <code>lib.meta</code>. Aha! <a href=https://ianthehenry.com/posts/how-to-learn-nix/even-more-functions-somehow/>I had forgotten about these functions</a>. But it seems that you can use the even shorter:</p>
<pre tabindex=0><code>python3 = lib.hiPrio python38;
</code></pre><p>But when I test that, I see that it doesn’t actually work. Because <code>lib.hiPrio</code> doesn’t call <code>overrideAttrs</code>; it just uses <code>//</code> notation. So it’s actually:</p>
<pre tabindex=0><code>python3 = python38.overrideAttrs lib.hiPrio;
</code></pre><p>That’s not too bad, though? And a <code>nix-env -qa --json</code> confirms that that does, in fact, work.</p>
<p>So… we can try opening a PR now? And maybe by doing so, we’ll learn the correct way to make such a change.</p>
<p>Maybe I should file an issue first, and then submit a PR to fix the issue. That seems nicer.</p>
<p><a href=https://github.com/NixOS/nixpkgs/issues/126036>https://github.com/NixOS/nixpkgs/issues/126036</a></p>
<p>There are 208 open issues for the search term <code>"python3"</code> right now. It asked me to notify the maintainer, but I feel kind of bad for doing so. I’m about to fix it, and I’d rather notify the maintainer on my PR, but whatever. I did what it asked.</p>
<p>Man. Nixpkgs is so big. I’m pulling changes right now, and it’s just… it’s taking a while. Only ~85mb of changes, but GitHub seems to be throttling me pretty hard. I don’t remember it taking this long for the initial clone. Maybe clones are easier, because protocols or something. Maybe I should’ve just cloned from scratch.</p>
<p>Anyway, I opened the PR:</p>
<p><a href=https://github.com/NixOS/nixpkgs/pull/126038>https://github.com/NixOS/nixpkgs/pull/126038</a></p>
<p>Perhaps someone will take the time to tell me the “right” way to do this. Or it will be closed as “this doesn’t matter what are you doing don’t ever use <code>nix-env -u</code>.” I <em>hope</em> not, but I do realize that this is a pretty subjective thing, and the way I think it “should” work may not match the way that actual Nixpkgs maintainers think it “should” work.</p>
<p>Anyway. I did my part. I learned the thing. I did <em>not</em> try to fix the weird broken <code>python3-3.10.0a5</code> derivation, but… that’s okay with me. I’ll update with the outcome of that PR. Although, you know, you’ll be able to see it. It’ll be in the PR.</p>
<aside>
<p>Update: See <a href=https://ianthehenry.com/posts/how-to-learn-nix/ambiguous-packages/>Part 41: Ambiguous Packages</a> for an update on this, and an explanation of why my bright-eyed bushy-tailed optimism was hopelessly misfounded.</p>
</aside>
<section class=footnotes role=doc-endnotes>
<hr>
<ol>
<li id=fn:1 role=doc-endnote>
<p>This is a good example of a downside of the Nixpkgs monolith. If these helper functions were separate from the package definitions, this wouldn’t be an issue. But instead we have this single Nix expression that contains every package and ever helper function and every NixOS module and every everything in the Nix universe.&nbsp;<a href=#fnref:1 class=footnote-backref role=doc-backlink>↩︎</a></p>
</li>
<li id=fn:2 role=doc-endnote>
<p>Note that although the <em>attribute</em> is called <code>python2</code>, the package is “named” <code>"python"</code>.&nbsp;<a href=#fnref:2 class=footnote-backref role=doc-backlink>↩︎</a></p>
</li>
</ol>
</section></div>
</article>
<div class=post-footer>
<a href="mailto:ianthehenry@gmail.com?subject=let%27s%20talk%20about%20%22How%20to%20install%20Python%22&amp;body=First%20of%20all,%20I%20just%20wanted%20to%20say%20that%20I%20forgive%20you%20for%20not%20having%20a%20real%20comment%20system%20on%20your%20site.">comment on this post</a><a href=https://ianthehenry.com/posts/how-to-learn-nix/open-questions/>Next up ➜ Open questions</a></div>
<aside class=series-rider>
<p>
This post is part of the series <a class=series-name href=https://ianthehenry.com/posts/how-to-learn-nix/>How to Learn Nix</a>.
You can
<a target=_blank href=https://ianthehenry.com/feed.xml>subscribe to my RSS feed</a>
or
<a target=_blank href=https://twitter.com/ianthehenry>follow me on Twitter</a>
for more, or <a href=https://ianthehenry.com/posts/>peruse my back catalog</a> if you're in the mood for something different.
<div class=subsection-header>Opening remarks</div><ol start=1 class=post-list><li><a href=https://ianthehenry.com/posts/how-to-learn-nix/introduction/>What's all this about?</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/prior-knowledge/>Prior knowledge</a></li>
</ol><div class=subsection-header>Reading the Nix manual</div><ol start=3 class=post-list><li><a href=https://ianthehenry.com/posts/how-to-learn-nix/glossary/>What we talk about when we talk about Nix</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/quick-start-guide/>Quick starts, full hearts</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/basic-package-management/>Basic package management</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/profiles/>Profiles</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/garbage-collection/>Garbage collection</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/channels/>Channels</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/sharing/>Learning to share</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/my-first-derivation/>My first derivation</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/okay-my-actual-first-derivation/>Okay my actual first derivation</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/nix-language/>The Nix expression language</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/derivations/>Derivations</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/built-in-functions/>Built-in Functions</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/advanced-topics/>Advanced Topics</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/command-reference/>Command Reference</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/configuration/>Configuration</a></li>
</ol><div class=subsection-header>Interlude: in which we follow our hearts, however briefly</div><ol start=18 class=post-list><li><a href=https://ianthehenry.com/posts/how-to-learn-nix/nix-manual-reflection/>So I read the manual huh</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/switching-from-homebrew-to-nix/>Switching from Homebrew to Nix</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/my-first-nix-bug/>My first Nix bug</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/my-first-package-upgrade/>My first package upgrade</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/declarative-user-environment/>Setting up a declarative user environment</a></li>
</ol><div class=subsection-header>Reading the Nixpkgs manual</div><ol start=23 class=post-list><li><a href=https://ianthehenry.com/posts/how-to-learn-nix/how-to-learn-nixpkgs/>How to learn Nixpkgs</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/overlays/>Overlays</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/overriding/>Overriding</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/an-infinite-list-of-functions/>An infinite list of functions</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/even-more-functions-somehow/>Even more functions, somehow</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/the-standard-environment/>The standard environment</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/derivations-in-detail/>Derivations in detail</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/cross-compilation/>Cross-compilation</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/platform-notes/>Platform notes</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/builders/>Builders</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/languages-and-frameworks/>Languages and frameworks</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/random-package-grab-bag/>Random package grab-bag</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/how-to-give-back/>How to give back</a></li>
</ol><div class=subsection-header>Documentation behind us, we set out on our own</div><ol start=36 class=post-list><li><a href=https://ianthehenry.com/posts/how-to-learn-nix/nixpkgs-reflection/>So I read the other manual, huh</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/saving-your-shell/>Saving your shell</a></li>
</ol><div class=subsection-header>Oh right forgot about Nix Pills</div><ol start=38 class=post-list><li><a href=https://ianthehenry.com/posts/how-to-learn-nix/nix-pills/>Nix Pills</a></li>
</ol><div class=subsection-header>Our whole lives ahead of us</div><ol start=39 class=post-list><li><strong><a href=https://ianthehenry.com/posts/how-to-learn-nix/python3-alpha/>How to install Python</a></strong>&nbsp;←&nbsp;you are here</li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/open-questions/>Open questions</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/ambiguous-packages/>Ambiguous packages</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/nix-zshell/>Running zsh in nix-shell</a></li>
</ol><div class=subsection-header>Nix 2.4 slithers to life</div><ol start=43 class=post-list><li><a href=https://ianthehenry.com/posts/how-to-learn-nix/flakes/>My first brush with flakes</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/more-flakes/>More flakes, unfortunately</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/new-profiles/>Fancy new profiles</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/chipping-away-at-flakes/>Chipping away at flakes</a></li>
<li><a href=https://ianthehenry.com/posts/how-to-learn-nix/nix-develop/>New and unimproved shells</a></li>
</ol>
</aside>
</main>
<footer>
© 1899-1907 <a href=https://ianthehenry.com/about/>Ian Henry</a>
</footer>
